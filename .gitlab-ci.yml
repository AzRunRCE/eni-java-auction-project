image: ubuntu

services:
  - name: microsoft/mssql-server-linux
    alias: mssql

variables:
  # Configure mysql environment variables (https://hub.docker.com/_/mysql/)
  ACCEPT_EULA: Y
  SA_PASSWORD: yourStrong(!)Password

before_script:
    - apt-get update 
    - apt-get install ant -y 
    - apt-get install curl -y 
    - apt-get install wget -y &>/dev/null
    - export JAVA_TOOL_OPTIONS=-Dfile.encoding=UTF8
    - export JAVA_OPTS=-Dfile.encoding=UTF8
    - wget -qO - https://packages.microsoft.com/keys/microsoft.asc | iconv -f windows-1251 |  apt-key add -
    - wget -qO - https://packages.microsoft.com/config/ubuntu/16.04/prod.list | iconv -f windows-1251 | tee /etc/apt/sources.list.d/msprod.list
    - apt-get update
    - apt-get install mssql-tools unixodbc-dev
    - echo 'export PATH="$PATH:/opt/mssql-tools/bin"' >> ~/.bash_profile
    - echo 'export PATH="$PATH:/opt/mssql-tools/bin"' >> ~/.bashrc
    - source ~/.bashrc
    - cd Encheres
stages:
  - build

builds:
  stage: build
  script:
    - ant -buildfile build-CI.xml
  artifacts:
    paths:
    - Encheres/dist/*.jar
    reports:
      junit: Encheres/testreports/*.xml

